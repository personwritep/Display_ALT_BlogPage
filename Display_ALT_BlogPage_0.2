// ==UserScript==
// @name        Display ALT BlogPage
// @namespace        http://tampermonkey.net/
// @version        0.2
// @description        „Éñ„É≠„Ç∞Ë®ò‰∫ã„ÅÆÁîªÂÉè„Å´„Éû„Ç¶„Çπ„Éõ„Éê„Éº„ÅßALT„ÇíË°®Á§∫
// @author        Ameba Blog User
// @match        https://ameblo.jp/*
// @exclude        https://ameblo.jp/*/image*
// @icon        https://www.google.com/s2/favicons?sz=64&domain=ameblo.jp
// @updateURL        https://github.com/personwritep/Display_ALT_BlogPage/raw/main/Display_ALT_BlogPage.user.js
// @downloadURL        https://github.com/personwritep/Display_ALT_BlogPage/raw/main/Display_ALT_BlogPage.user.js
// @grant        none
// ==/UserScript==



let adisp=
    '<div class="alt_disp"><span ></span>'+
    '<style>'+
    '.alt_disp { position: absolute; z-index: -2; font: normal 14px/16px Meiryo; '+
    'padding: 3px 6px 1px; color: #000; border: 1px solid #aaa; background: #fff; }'+
    '</style></div>';

if(!document.querySelector('.alt_disp')){
    document.body.insertAdjacentHTML('beforeend', adisp); }



document.addEventListener('mouseover', function(event) {
    let pelement=event.target;
    if(pelement.tagName=='IMG'){
        disp(pelement); }});



function disp(pelement){
    let scroll_html=document.documentElement;
    let spos_y=scroll_html.scrollTop;
    let pos_x=pelement.getBoundingClientRect().left+4;
    let pos_y=pelement.getBoundingClientRect().top+spos_y+2;

    let alt_disp=document.querySelector('.alt_disp');
    let alt_disp_span=document.querySelector('.alt_disp span');
    let alt_text=pelement.getAttribute('alt');
    if(alt_text && alt_disp && alt_disp_span){
        alt_disp_span.textContent=alt_text;
        alt_disp.style.left=pos_x+'px';
        alt_disp.style.top=pos_y+'px';
        alt_disp.style.zIndex='1999';

        disp_keep(alt_disp);
        disp_out(pelement, alt_disp); }}



function disp_out(pelem, alt_disp){
    pelem.onmouseleave=()=>{
        alt_disp.style.zIndex='-2'; }
    pelem.onmouseover=()=>{
        alt_disp.style.zIndex='1999'; }}


function disp_keep(alt_disp){
    alt_disp.onmouseover=()=>{
        alt_disp.style.zIndex='1999'; }
    alt_disp.onmouseleave=()=>{
        alt_disp.style.zIndex='-2'; }}




/* === ‰ª£Êõø„ÉÜ„Ç≠„Çπ„Éà„ÅÆÁÑ°„ÅÑGifÁîªÂÉè„Å´Ëµ§„Éû„Éº„ÇØ„ÇíË°®Á§∫ === */
/* üî¥üî¥ „Åì„ÅÆÊ©üËÉΩ„Åå‰∏çË¶Å„ÅÆÂ†¥Âêà„ÅØ ‰ª•‰∏ã„ÅÆ„Ç≥„Éº„Éâ„ÇíÂÖ®„Å¶ÂâäÈô§ */


window.onscroll=()=>{
    gif_mark(); }


function gif_mark(){
    let imgall=document.querySelectorAll('img');
    for(let k=0; k<imgall.length; k++){
        let src=imgall[k].getAttribute('src');
        if(src && src.includes('.gif')){
            if(imgall[k].getAttribute('alt')==''){
                let root=imgall[k].closest('.ogpCard_root');
                if(root){
                    root.style.boxShadow=
                        '-20px 0px 0 0px #fff, -40px 0 0 red'; }
                else{
                    imgall[k].style.boxShadow=
                        '-20px 0px 0 0px #fff, -40px 0 0 red'; }}}}}

